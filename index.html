
			<head>
				<link rel="stylesheet" type="text/css" href="https://cloud.typography.com/610186/6122012/css/fonts.css"><link rel="stylesheet" type="text/css" href="https://css-tricks.com/wp-content/themes/CSS-Tricks-17/style.css?cache_bust=1582072356306"><link rel="stylesheet" type="text/css" href="https://c0.wp.com/p/jetpack/8.2.3/modules/widgets/search/css/search-widget-frontend.css">
				<style>img#wpstats{display:none}
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
				<meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
				<style>body{ background-color: white}</style>
			</head>
				
			
<header class="mega-header mega-header-article header-with-bottom-gradient header-breadcrumbs" id="maincontent">
<style>
    .mega-header::before {
      content: "";
      position: absolute;
      top: 0;
      right: 0;
      width: 75%;
      height: 90%;
              background-image:
          radial-gradient(ellipse closest-side, rgba(15, 14, 22, 0.5), #100e17),
          url(https://res.cloudinary.com/css-tricks/image/fetch/w_1200,q_auto,f_auto/https://res.cloudinary.com/css-tricks/image/upload/$wpsize_!_cld_full!,w_1200,h_600,c_scale/v1582755825//bears-featured.png);
            background-size: cover;
      background-repeat: no-repeat;
      opacity: 0.75;
    }
  </style>
<div class="mega-header-inside">
<div class="mega-header-header">
<span>
<a href="/">Home</a> <span class="breadcrumb-separator">/</span>
<span>
<a href="/archives/">Articles</a> <span class="breadcrumb-separator">/</span>
</span>
</span>
<h1>
Animated Matryoshka Dolls in&#xA0;CSS </h1>
<div class="article-content-meta">
<div class="author-avatar">
<a href="https://css-tricks.com/author/jheytompkins/">
<img alt="Avatar of Jhey Tompkins" class="avatar avatar-80 photo avatar-default" height="80" src="https://css-tricks.com/wp-content/uploads/2019/09/bear-with-cap-scaled-80x80.png" width="80"><noscript><img alt="Avatar of Jhey Tompkins" class="avatar avatar-80 photo avatar-default" height="80" src="https://css-tricks.com/wp-content/uploads/2019/09/bear-with-cap-scaled-80x80.png" width="80"></noscript> </a>
<svg class="half-circle" width="80px" height="80px">
<use href="#half-circle"/>
</svg>
</div>
<div class="author-name-area">
<div class="author-name-prefix">
Author
</div>
<a class="author-name" href="https://css-tricks.com/author/jheytompkins/">
Jhey Tompkins </a>
</div>
<div class="article-comments-meta">
<div class="comments-prefix">
1 Comment </div>
<a class="comments-link" href="https://css-tricks.com/animated-matryoshka-dolls-in-css/#comments">
Join Conversation
<svg viewBox="0 0 24 24" class="icon-arrow-right" xmlns="http://www.w3.org/2000/svg">
<path d="M7 12.5L23 12.5" stroke="url(#paint0_linear)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M1 12.5H2" stroke="url(#paint1_linear)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M17.5 7L23 12.5L17.5 18" stroke="url(#paint2_linear)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<defs>
<linearGradient id="paint0_linear" x1="10.7498" y1="12.5" x2="11.3447" y2="9.73465" gradientUnits="userSpaceOnUse">
<stop stop-color="#FF8A00"/>
<stop offset="1" stop-color="#DA1B60"/>
</linearGradient>
<linearGradient id="paint1_linear" x1="1.23436" y1="12.5" x2="2.00945" y2="12.2748" gradientUnits="userSpaceOnUse">
<stop stop-color="#FF8A00"/>
<stop offset="1" stop-color="#DA1B60"/>
</linearGradient>
<linearGradient id="paint2_linear" x1="18.789" y1="17.9995" x2="23.3162" y2="17.3419" gradientUnits="userSpaceOnUse">
<stop stop-color="#FF8A00"/>
<stop offset="1" stop-color="#DA1B60"/>
</linearGradient>
</defs>
</svg>
</a>
</div>
<div class="date">
<div class="date-prefix">
Published
</div>
<time datetime>
Feb 27, 2020 </time>
</div>
</div>
<div class="tags">
<a href="https://css-tricks.com/tag/checkbox-hack/" rel="tag">checkbox hack</a> <a href="https://css-tricks.com/tag/css-animation/" rel="tag">css animation</a> <a href="https://css-tricks.com/tag/keyframes/" rel="tag">keyframes</a> </div>
</div>
<div class="hero-article-ad" id="hero-article-ad">
</div>
</div>
</header>
<div class="header-gradient-after">
<div class="header-gradient-content">
<div class="header-gradient-content-inside">
<div class="bold-underline-links header-gradient-sponsor">
<p>
Learn Development at <a href="https://synd.co/36GY7hS">Frontend Masters</a>
</p> </div>
</div>
</div>
</div>
<div class="page-wrap page-wrap-single">
<div class="article-and-sidebar on-light">
<div class="article-content">
<p>Here&#x2019;s a fun one. How might we create a set of those cool Matryoshka dolls where they nest inside one another... but in CSS?</p>
<p>I toyed with this idea in my head for a little while. Then, I saw a tweet from CSS-Tricks and the article image had the dolls. I took that as a sign! It was time to put fingers to the keyboard.</p>
<figure class="wp-block-image size-large"><img src="https://i0.wp.com/res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1582755002//matryoshka-dolls.png?ssl=1" alt class="wp-image-296824 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/c_scale,w_1200/v1582755002//matryoshka-dolls.png 1200w, https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/c_scale,w_848/v1582755002//matryoshka-dolls.png 848w, https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/c_scale,w_579/v1582755002//matryoshka-dolls.png 579w, https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/c_scale,w_50/v1582755002//matryoshka-dolls.png 50w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i0.wp.com/res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1582755002//matryoshka-dolls.png?ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://i0.wp.com/res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1582755002//matryoshka-dolls.png?ssl=1" alt="" class="wp-image-296824" srcset="https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/c_scale,w_1200/v1582755002//matryoshka-dolls.png 1200w, https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/c_scale,w_848/v1582755002//matryoshka-dolls.png 848w, https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/c_scale,w_579/v1582755002//matryoshka-dolls.png 579w, https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/c_scale,w_50/v1582755002//matryoshka-dolls.png 50w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<p>Our goal here is to make these fun and interactive, where we can click on a doll to open it up and reveal another, smaller doll. Oh, and stick with just CSS for the functionality. And while we&#x2019;re at it, let&#x2019;s replace the dolls with our own character, say a CodePen bear. Something like this:</p>
<figure class="wp-block-image size-large"><img src="https://i0.wp.com/res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1582755828//beqrs-finalbears-final.gif?ssl=1" alt class="wp-image-303772 jetpack-lazy-image" data-recalc-dims="1" data-lazy-src="https://i0.wp.com/res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1582755828//beqrs-finalbears-final.gif?ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://i0.wp.com/res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1582755828//beqrs-finalbears-final.gif?ssl=1" alt="" class="wp-image-303772" data-recalc-dims="1"/></noscript></figure>
<p>We won&apos;t dwell on making things pretty to start. Let&apos;s get some markup on the page and thrash out the mechanics first.</p>
<p>We can&#x2019;t have an infinite amount of dolls. When we reach the innermost doll, it&apos;d be nice to be able to reset the dolls without having to do a page refresh. A neat trick for this is to wrap our scene in an HTML form. That way we can use an input and set the <code>type</code>&#xA0;attribute to <code>reset</code> to avoid using any JavaScript.</p>
<pre rel="HTML" class="wp-block-csstricks-code-block language-markup" data-line><code markup="tt">&lt;form&gt;
  &lt;input type=&quot;reset&quot; id=&quot;reset&quot;/&gt;
  &lt;label for=&quot;reset&quot; title=&quot;Reset&quot;&gt;Reset&lt;/label&gt;
&lt;/form&gt;</code></pre>
<p>Next, we need some dolls. Or bears. Or something to start with. The key here will be to use the classic <a href="https://css-tricks.com/the-checkbox-hack/">checkbox hack</a> and any associated form labels. As a note, I&#x2019;m going to use Pug to handle the markup because it supports loops, making things a little easier. But, you can certainly write the HTML by hand. Here&#x2019;s the start with form fields and labels that set up the checkbox hack.</p>
<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_RwNmPwr" src="//codepen.io/anon/embed/RwNmPwr?height=350&amp;theme-id=1&amp;slug-hash=RwNmPwr&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed RwNmPwr" title="CodePen Embed RwNmPwr" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>
<p>Try clicking some of the inputs and hitting the Reset input. They all become unchecked. Nice, we&#x2019;ll use that.</p>
<p>We have some interactivity but nothing is really happening yet. Here&#x2019;s the plan:</p>
<ol><li>We&#x2019;ll only show one checkbox at a time</li><li>Checking a checkbox should reveal the label for the next checkbox.</li><li>When we get to the last checkbox, there our only option should be to reset the form.</li></ol>
<p>The trick will be to make use of the CSS adjacent sibling combinator (<code>+</code>).</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line><code markup="tt">input:checked + label + input + label {
&#xA0; display: block;
}</code></pre>
<p>When a checkbox is checked, we need to show the label for the next doll, which will be three siblings along in the DOM. How do we make the first label visible? Give it an explicit <code>display: block</code> via inline styles in our markup. Putting this together, we have something along these lines:</p>
<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_MWYdwjP" src="//codepen.io/anon/embed/MWYdwjP?height=350&amp;theme-id=1&amp;slug-hash=MWYdwjP&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed MWYdwjP" title="CodePen Embed MWYdwjP" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>
<p>Clicking each label reveals the next. Hold on, the last label isn&#x2019;t shown! That&#x2019;s correct. And that&#x2019;s because the last label doesn&#x2019;t have a checkbox. We need to add a rule that caters to that last label.</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line><code markup="tt">input:checked + label + input + label,
input:checked + label + label {
  display: block;
}</code></pre>
<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_NWPVqyM" src="//codepen.io/anon/embed/NWPVqyM?height=350&amp;theme-id=1&amp;slug-hash=NWPVqyM&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed NWPVqyM" title="CodePen Embed NWPVqyM" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>
<p>Cool. We&apos;re getting somewhere. That&apos;s the basic mechanics. Now things are going to get a little trickier.&#xA0;</p>
<h3>Basic styling</h3>
<p>So, you might be thinking, &#x201C;Why aren&#x2019;t we hiding the checked label?&#x201D; Good question! But, if we hide it straight away, we won&#x2019;t have any transition between the current doll and the next. Before we start animating our dolls, let&#x2019;s create basic boxes that will represent a doll. We can style them up so they mimic the doll outline without the detail.</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line><code markup="tt">.doll {
  color: #fff;
  cursor: pointer;
  height: 200px;
  font-size: 2rem;
  left: 50%;
  position: absolute;
  text-align: center;
  top: 50%;
  transform: translate(-50%, -50%);
  width: 100px;
}

.doll:nth-of-type(even) {
  background: #00f;
}

.doll:nth-of-type(odd) {
  background: #f00;
}</code></pre>
<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_oNgRjvZ" src="//codepen.io/anon/embed/oNgRjvZ?height=350&amp;theme-id=1&amp;slug-hash=oNgRjvZ&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed oNgRjvZ" title="CodePen Embed oNgRjvZ" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>
<p>Clicking one doll instantly reveals the next one and, when we&#x2019;ve reached the last doll, we can reset the form to start again. That&#x2019;s what we want here.</p>
<h3>The mechanics</h3>
<p>We are going to animate the dolls based on a center point. Our animation will consist of many steps:</p>
<ol><li>Slide the current doll out to the left.</li><li>Open the doll to reveal the next one.</li><li>Move the next doll where the current one started.</li><li>Make the current doll fade out.</li><li>Assign the next doll as the current doll.</li></ol>
<p>Let&#x2019;s start by sliding the current doll out to the left. We apply an animation when we click a label. Using the <code>:checked</code> pseudo-selector we can target the current doll. At this point, it&#x2019;s worth noting that we are going to use CSS variables to control animation speed and behavior. This will make it easier to chain animations on the labels.</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line><code markup="tt">:root {
  --speed: 0.25;
  --base-slide: 100;
  --slide-distance: 60;
}

input:checked + label {
  animation: slideLeft calc(var(--speed) * 1s) forwards;
}

@keyframes slideLeft {
  to {
    transform: translate(calc((var(--base-slide) * -1px) + var(--slide-distance) * -1%), 0);
  }
}</code></pre>
<p>That looks great. But there&#x2019;s an issue. As soon as we click a label, we could click it again and reset the animation. We don&apos;t want that to happen.</p>
<figure class="wp-block-image size-large"><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-01.gif?ssl=1" alt class="wp-image-303763 jetpack-lazy-image" data-recalc-dims="1" data-lazy-src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-01.gif?ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-01.gif?ssl=1" alt="" class="wp-image-303763" data-recalc-dims="1"/></noscript></figure>
<p>How can we get around this? We can remove pointer events from a label once it&#x2019;s been clicked.</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line><code markup="tt">input:checked + label {
  animation: slideLeft calc(var(--speed) * 1s) forwards;
  pointer-events: none;
}</code></pre>
<figure class="wp-block-image size-large"><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-02.gif?ssl=1" alt class="wp-image-303764 jetpack-lazy-image" data-recalc-dims="1" data-lazy-src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-02.gif?ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-02.gif?ssl=1" alt="" class="wp-image-303764" data-recalc-dims="1"/></noscript></figure>
<p>Great! Now once we have started, we can&#x2019;t stop the animation chain from happening.</p>
<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_KKwLdXP" src="//codepen.io/anon/embed/KKwLdXP?height=350&amp;theme-id=1&amp;slug-hash=KKwLdXP&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed KKwLdXP" title="CodePen Embed KKwLdXP" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>
<p>Next up, we need to crack open the doll to reveal the next one. This is where things get tricky because we are going to need some extra elements, not only to create the effect that the doll is opening up, but also to reveal the next doll inside of it. That&apos;s right: we need to duplicate the inner doll. The trick here is to reveal a &quot;fake&quot; doll that we swap for the real one once we&apos;ve animated it. This also means delaying the reveal of the next label.</p>
<p>Now our markup updates labels so that they contains span elements.</p>
<pre rel="HTML" class="wp-block-csstricks-code-block language-markup" data-line><code markup="tt">&lt;label class=&quot;doll&quot; for=&quot;doll--1&quot;&gt;
  &lt;span class=&quot;doll doll--dummy&quot;&gt;&lt;/span&gt;
  &lt;span class=&quot;doll__half doll__half--top&quot;&gt;Top&lt;/span&gt;
  &lt;span class=&quot;doll__half doll__half--bottom&quot;&gt;Bottom&lt;/span&gt;
&lt;/label&gt;</code></pre>
<p>These will act as the &#x201C;dummy&#x201D; doll as well as the lid and base for the current doll.</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line><code markup="tt">.doll {
  color: #fff;
  cursor: pointer;
  height: 200px;
  font-size: 2rem;
  position: absolute;
  text-align: center;
  width: 100px;
}

.doll:nth-of-type(even) {
  --bg: #00f;
  --dummy-bg: #f00;
}

.doll:nth-of-type(odd) {
  --bg: #f00;
  --dummy-bg: #00f;
}

.doll__half {
  background: var(--bg);
  position: absolute;
  width: 100%;
  height: 50%;
  left: 0;
}

.doll__half--top {
  top: 0;
}

.doll__half--bottom {
  bottom: 0;
}

.doll__dummy {
  background: var(--dummy-bg);
  height: 100%;
  width: 100%;
  position: absolute;
  top: 0;
  left: 0;
}</code></pre>
<p>The lid requires three translations to create the opening effect: one to pop it up, one to move it left and then one to pop it down.</p>
<figure class="wp-block-image size-large"><img src="https://i2.wp.com/res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1582756099//bears-03.png?ssl=1" alt class="wp-image-303765 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/c_scale,w_1200/v1582756099//bears-03.png 1200w, https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/c_scale,w_50/v1582756099//bears-03.png 50w" data-lazy-sizes="(min-width: 735px) 864px, 96vw" data-lazy-src="https://i2.wp.com/res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1582756099//bears-03.png?ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://i2.wp.com/res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1582756099//bears-03.png?ssl=1" alt="" class="wp-image-303765" srcset="https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/c_scale,w_1200/v1582756099//bears-03.png 1200w, https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/c_scale,w_50/v1582756099//bears-03.png 50w" sizes="(min-width: 735px) 864px, 96vw" data-recalc-dims="1" /></noscript></figure>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line><code markup="tt">@keyframes open {
  0% {
    transform: translate(0, 0);
  }
  33.333333333333336% {
    transform: translate(0, -100%);
  }
  66.66666666666667% {
    transform: translate(-100%, -100%);
  }
  100% {
    transform: translate(-100%, 100%);
  }
}</code></pre>
<p>Next is where we can use CSS custom properties to handle changing values. Once the doll has slid over to the left, we can open it. But how do we know how long to delay it from opening until that happens? We can use the <code>--speed</code> custom property we defined earlier to calculate the correct delay.</p>
<p>It looks a little quick if we use the <code>--speed</code> value as it is, so let&#x2019;s multiply it by two seconds:</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line><code markup="tt">input:checked + .doll {
  animation: slideLeft calc(var(--speed) * 1s) forwards;
  pointer-events: none;
}

input:checked + .doll .doll__half--top {
  animation: open calc(var(--speed) * 2s) calc(var(--speed) * 1s) forwards; // highlight
}</code></pre>
<p>Much better:</p>
<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_LYEopKm" src="//codepen.io/anon/embed/LYEopKm?height=350&amp;theme-id=1&amp;slug-hash=LYEopKm&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed LYEopKm" title="CodePen Embed LYEopKm" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>
<p>Now we need to move the inner &#x201C;dummy&#x201D; doll to the new position. This animation is like the open animation in that it consists of three stages. Again, that&#x2019;s one to move up, one to move right, and one to set down. It&apos;s like the slide animation, too. We are going to use CSS custom properties to determine the distance that the doll moves.</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line><code markup="tt">:root {
  // Introduce a new variable that defines how high the dummy doll should pop out.
  --pop-height: 60;
}

@keyframes move {
  0% {
    transform: translate(0, 0) translate(0, 0);
  }
  33.333333333333336% {
    transform: translate(0, calc(var(--pop-height) * -1%)) translate(0, 0);
  }
  66.66666666666667% {
    transform: translate(0, calc(var(--pop-height) * -1%)) translate(calc((var(--base-slide) * 1px) + var(--slide-distance) * 1%), 0);
  }
  100% {
    transform: translate(0, calc(var(--pop-height) * -1%)) translate(calc((var(--base-slide) * 1px) + var(--slide-distance) * 1%), calc(var(--pop-height) * 1%));
  }
}</code></pre>
<p>Almost there!&#xA0;</p>
<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_wvBbYmP" src="//codepen.io/anon/embed/wvBbYmP?height=350&amp;theme-id=1&amp;slug-hash=wvBbYmP&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed wvBbYmP" title="CodePen Embed wvBbYmP" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>
<p>The only thing is that the next doll is available as soon as we click a doll. that means we can spam click our way through the set.</p>
<figure class="wp-block-image size-large"><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-04.gif?ssl=1" alt class="wp-image-303767 jetpack-lazy-image" data-recalc-dims="1" data-lazy-src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-04.gif?ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-04.gif?ssl=1" alt="" class="wp-image-303767" data-recalc-dims="1"/></noscript></figure>
<p>Technically, the next doll shouldn&#x2019;t show until the &#x201C;fake&#x201D; one has moved into place. It&#x2019;s only once the &#x201C;fake&#x201D; doll is in place that we can hide it and reveal the real one. That means we going to use zero-second scale animations! That&apos;s right. We can play pretend by delaying two zero-second animations and using <code>animation-fill-mode</code>.</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line><code markup="tt">@keyframes appear {
  from {
    transform: scale(0);
  }
}</code></pre>
<p>We actually only need one set of <code>@keyframes</code>. because we can re-use what we have to create the opposite movement with <code>animation-direction: reverse</code>. With that in mind, all our animations get applied something like this:</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line><code markup="tt">// The next doll
input:checked + .doll + input + .doll,
// The last doll (doesn&apos;t have an input)
input:checked + .doll + .doll {
  animation: appear 0s calc(var(--speed) * 5s) both;
  display: block;
}

// The current doll
input:checked + .doll,
// The current doll that isn&apos;t the first. Specificity prevails
input:checked + .doll + input:checked + .doll {
  animation: slideLeft calc(var(--speed) * 1s) forwards;
  pointer-events: none;
}

input:checked + .doll .doll__half--top,
input:checked + .doll + input:checked + .doll .doll__half--top {
  animation: open calc(var(--speed) * 2s) calc(var(--speed) * 1s) forwards;
}

input:checked + .doll .doll__dummy,
input:checked + .doll + input:checked + .doll .doll__dummy {
  animation: move calc(var(--speed) * 2s) calc(var(--speed) * 3s) forwards, appear 0s calc(var(--speed) * 5s) reverse forwards;
}</code></pre>
<p>Note how important the variables are, especially where we are chaining animations. That gets us almost where we need to be.</p>
<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_povmxMG" src="//codepen.io/anon/embed/povmxMG?height=350&amp;theme-id=1&amp;slug-hash=povmxMG&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed povmxMG" title="CodePen Embed povmxMG" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>
<p>I can hear it now: &quot;They&apos;re all the same size!&quot; Yep. That&apos;s the missing piece. They need to scale down. The trick here is to adjust the markup again and make use of CSS custom properties yet again.</p>
<pre rel="HTML" class="wp-block-csstricks-code-block language-html" data-line="3,5,6,9"><code markup="tt">&lt;input id=&quot;doll--0&quot; type=&quot;checkbox&quot;/&gt;
&lt;label class=&quot;doll&quot; for=&quot;doll--0&quot; style=&quot;display: block; --doll-index: 0;&quot;&gt;
  &lt;span class=&quot;doll__dummy-container&quot;&gt;
    &lt;span class=&quot;doll__dummy&quot;&gt;&lt;/span&gt;
  &lt;/span&gt; //highlight
  &lt;span class=&quot;doll__container&quot;&gt;
    &lt;span class=&quot;doll__half doll__half--top&quot;&gt;&lt;/span&gt;
    &lt;span class=&quot;doll__half doll__half--bottom&quot;&gt;&lt;/span&gt;
  &lt;/span&gt;
&lt;/label&gt;</code></pre>
<p>We just introduced a CSS custom property inline that tells us the index of the doll. We can use this to generate a scale of each half as well as the fake inner doll. The halves will have to scale to match the actual doll size, but the fake inner doll scale will need to match that of the next doll. Tricky!</p>
<p>We can apply these scales inside the containers so that our animations are not affected.</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line="15,24"><code markup="tt">:root {
  --scale-step: 0.05;
}

.doll__container,
.doll__dummy-container {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.doll__container {
  transform: scale(calc(1 - ((var(--doll-index)) * var(--scale-step))));
  transform-origin: bottom;
}

.doll__dummy {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  transform: scale(calc(1 - ((var(--doll-index) + 1) * var(--scale-step))));
  transform-origin: bottom center;
  width: 100%;
}</code></pre>
<p>Note how the <code>.doll__dummy</code> class uses <code>var(--doll-index) + 1)</code> to calculate the scale so that it matches the next doll. &#xA0;&#x1F44D;</p>
<p>Lastly, we re-assign the animation to the <code>.doll__dummy-container</code> class instead of the <code>.doll__dummy</code> class.</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line><code markup="tt">input:checked + .doll .doll__dummy-container,
input:checked + .doll + input:checked + .doll .doll__dummy-container {
  animation: move calc(var(--speed) * 2s) calc(var(--speed) * 3s) forwards, appear 0s calc(var(--speed) * 5s) reverse forwards;
}</code></pre>
<p>Here&apos;s a demo where the containers have been given a background color to see what&#x2019;s happening.</p>
<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_yLydOwQ" src="//codepen.io/anon/embed/yLydOwQ?height=350&amp;theme-id=1&amp;slug-hash=yLydOwQ&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed yLydOwQ" title="CodePen Embed yLydOwQ" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>
<p>We can see that, although the content size changes, they remain the same size. This makes for consistent animation behavior and makes the code easier to maintain.</p>
<h3>Finishing touches</h3>
<p>Wow, things are looking pretty slick! All we need are some finishing touches and we are done!</p>
<figure class="wp-block-image size-large"><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-905.gif?ssl=1" alt class="wp-image-303768 jetpack-lazy-image" data-recalc-dims="1" data-lazy-src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-905.gif?ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://i1.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-905.gif?ssl=1" alt="" class="wp-image-303768" data-recalc-dims="1"/></noscript></figure>
<p>The scene starts to look cluttered because we&#x2019;re stacking the &#x201C;old&#x201D; dolls off to the side when a new one is introduced. So let&apos;s slide a doll out of view when the next one is revealed to clean that mess up.</p>
<pre rel="CSS" class="wp-block-csstricks-code-block language-css" data-line><code markup="tt">@keyframes slideOut {
  from {
    transform: translate(calc((var(--base-slide) * -1px) + var(--slide-distance) * -1%), 0);
  }
  to {
    opacity: 0;
    transform: translate(calc((var(--base-slide) * -1px) + var(--slide-distance) * -2%), 0);
  }
}

input:checked + .doll,
input:checked + .doll + input:checked + .doll {
  animation: slideLeft calc(var(--speed) * 1s) forwards,
    slideOut calc(var(--speed) * 1s) calc(var(--speed) * 6s) forwards;
  pointer-events: none;
}</code></pre>
<p>The new <code>slideOut</code> animation fades the doll out while it translates to the left. Perfect. &#xA0;&#x1F44D;</p>
<figure class="wp-block-image size-large"><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-06.gif?ssl=1" alt class="wp-image-303769 jetpack-lazy-image" data-recalc-dims="1" data-lazy-src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-06.gif?ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://i0.wp.com/css-tricks.com/wp-content/uploads/2020/02/bears-06.gif?ssl=1" alt="" class="wp-image-303769" data-recalc-dims="1"/></noscript></figure>
<p>That&#x2019;s it for the CSS trickery we need to make this effect work. All that&#x2019;s left style the dolls and the scene.</p>
<p>We have many options to style the dolls. We could use a background image, CSS illustration, SVG, or what have you. We could even throw together some emoji dolls that use random inline hues!</p>
<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_oNgrBYY" src="//codepen.io/anon/embed/oNgrBYY?height=350&amp;theme-id=1&amp;slug-hash=oNgrBYY&amp;default-tab=result" height="350" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed oNgrBYY" title="CodePen Embed oNgrBYY" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>
<p>Let&#x2019;s go with inline SVG.</p>
<p>I&#x2019;m basically using the same underlying mechanics we&#x2019;ve already covered. The difference is that I&#x2019;m also generating inline variables for hue and lightness so the bears sport different shirt colors.</p>
<div class="wp-block-cp-codepen-gutenberg-embed-block cp_embed_wrapper"><iframe id="cp_embed_jOOYMLm" src="//codepen.io/anon/embed/jOOYMLm?height=500&amp;theme-id=1&amp;slug-hash=jOOYMLm&amp;default-tab=result" height="500" scrolling="no" frameborder="0" allowfullscreen allowpaymentrequest name="CodePen Embed jOOYMLm" title="CodePen Embed jOOYMLm" class="cp_embed_iframe" style="width:100%;overflow:hidden">CodePen Embed Fallback</iframe></div>
<hr class="wp-block-separator">
<p>There we have it! Stacking dolls &#x2014; err, bears &#x2014; with nothing but HTML and CSS! All the code for all the steps is available in <a href="https://codepen.io/collection/nmqWpx">this CodePen collection</a>. Questions or suggestions? Feel free to reach out to me here in the comments.</p>
</div>
<aside class="entry-unrelated sidebar">
<div id="all-ads">
<div id="scroll-ad-position"></div>
<div id="sticky-sidebar-stuff">
<div id="conditional-message">
<div class="fem-ad fem-sidebar-ad">
 <div class="fem-header">
<div class="fem-header-inner">
<div class="fem-learning-partner">
Our Learning Partner
</div>
<a href="https://frontendmasters.com/courses/svg-essentials-animation/?utm_source=css-tricks&amp;utm_medium=website&amp;utm_campaign=css-tricks-tags-sidebar"><img src="https://res.cloudinary.com/css-tricks/image/upload/f_auto,q_auto/v1578237555/FEM-sidebar-SVG_erbh7z.png" alt="Frontend Masters logo" class="fem-logo"></a>
</div>
</div>
<svg class="fem-diagonal" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 10" preserveAspectRatio="none"><defs><linearGradient id="linear" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="#c02d28"/><stop offset="100%" stop-color="#e66225"/></linearGradient></defs><polygon points="0,2 0,0 100,0 100,10" fill="url(#linear)"/></svg>
<div class="fem-message">
<h4>Wanna learn SVG &amp; Animation deeply?</h4>
<p><a href="https://frontendmasters.com/?utm_source=css-tricks&amp;utm_medium=website&amp;utm_campaign=css-tricks-tags-sidebar">Frontend Masters</a> has <a href="https://frontendmasters.com/courses/svg-essentials-animation/?utm_source=css-tricks&amp;utm_medium=website&amp;utm_campaign=css-tricks-tags-sidebar">an incredible course on all things CSS and SVG animation</a> from CSS-Tricks own Sarah Drasner. Sarah comprehensively covers the possibilty of animation, the tools, and does it all in a very practical way.</p>
</div>
</div>
</div> </div>
</div>
</aside>
</div>
</div>

				
			
			<script>
			document.querySelectorAll('noscript').forEach((x, i) => {
				x.insertAdjacentHTML('afterend',  x.innerHTML)
			})
			</script>